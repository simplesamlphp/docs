<!DOCTYPE html>
<html lang="en">
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Language" content="en">
  <meta name="google-site-verification" content="2S8M18BgYs8cLRL6ClTrfW_xGxfFtMZu2b2jhjrNlss">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>SimpleSAMLphp Documentation</title>

  <link rel="stylesheet" href="/res/css/style.css">
  <link rel="stylesheet" href="/res/css/layout.css">
</head>
<body>
<header>
 <div id="header">
  <div class="right">
   <form action="https://www.google.com/cse" method="get" style="margin-top: 2.5rem; margin-right: 2rem">
    <input name="cx" type="hidden" value="004202914224971217557:8ks4jjstupq"/>
    <input name="siteurl" type="hidden" value="www.google.com/cse/home?cx=004202914224971217557:8ks4jjstupq"/>
    <input name="adkw" type="hidden" value="AELymgVJ6Sk-kOvUjbxvgShTLwiFlma2evFuVCh0r8q23vn_4eVnkcdnPfbgMvYUTpJpVlb-KkGAKkbn0i-AlWHsVRR9O0J4CNb6cXFkEKRdjXxsC_NlVD4"/>
    <input name="q" placeholder="Search" type="search" value=""/>
   </form>
  </div>
  <div class="v-center logo-header">
   <div id="logo">
    <a href="https://simplesamlphp.org" style="color: #fff; text-decoration: none">
     <span class="simple">
      Simple
     </span>
     <span class="saml">
      SAML
     </span>
     <span class="simple">
      php
     </span>
    </a>
   </div>
  </div>
 </div>
 <!-- Grey header bar below -->
 <nav>
  <div id="headerbar" style="clear: both">
   <p id="breadcrumb">
    <a href="https://simplesamlphp.org">
     Home
    </a>
    » Documentation
   </p>
   <div class="mtoolbar">
    <div class="menuitem first">
     <a href="/docs/latest/index.html">
      latest
     </a>
    </div>
    <div class="menuitem">
     <a href="/docs/1.19/index.html">
      1.19
     </a>
    </div>
    <div class="menuitem">
     <a href="/docs/1.18/index.html">
      1.18
     </a>
    </div>
    <div class="menuitem">
     <a href="/docs/1.17/index.html">
      1.17
     </a>
    </div>
    <div class="menuitem">
     <a href="/docs/1.16/index.html">
      1.16
     </a>
    </div>
    <div class="menuitem last">
     <a href="/docs/contributed_modules.html">
      Contributed modules
     </a>
    </div>
   </div>
   <br style="height: 0px; clear: both"/>
  </div>
  <!-- /#headerbar -->
 </nav>
 <div id="content">
 </div>
</header><h1 id="expirycheck-module">
 expirycheck module
</h1>
<p>
 The expirycheck module validates user's expiry date attribute by showing
warning to the user whose NetID is about to expire or denying access if NetID
has already expired.
</p>
<p>
 The expirycheck module is implemented as an Authentication Processing Filter.
That means it can be configured in the global config.php file or the SP remote
or IdP hosted metadata.
</p>
<p>
 It is recommended to run the expirycheck module at the IdP, and configure the
filter to run before all the other filters you may have enabled.
</p>
<h2 id="how-to-setup-the-expirycheck-module">
 How to setup the expirycheck module
</h2>
<p>
 First you need to enable the expirycheck module, touch an
 <code>
  enable
 </code>
 file, in the
expirycheck module:
</p>
<div class="codehilite">
 <pre><span></span><code>  touch modules/expirycheck/enable
</code></pre>
</div>
<p>
 Then you need to set filter parameters in your config.php file.
</p>
<p>
 Example:
</p>
<div class="codehilite">
 <pre><span></span><code><span class="mf">10</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">array</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="err">'</span><span class="n">class</span><span class="err">'</span><span class="w">     </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">'</span><span class="nb">exp</span><span class="n">irycheck</span><span class="p">:</span><span class="nb">Exp</span><span class="n">iryDate</span><span class="err">'</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="err">'</span><span class="n">netid_attr</span><span class="err">'</span><span class="w">    </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">'</span><span class="n">eduPersonPrincipalName</span><span class="err">'</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="err">'</span><span class="nb">exp</span><span class="n">irydate_attr</span><span class="err">'</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">'</span><span class="n">schacExpiryDate</span><span class="err">'</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="err">'</span><span class="n">warndaysbefore</span><span class="err">'</span><span class="w">  </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">'</span><span class="mf">60</span><span class="err">'</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="err">'</span><span class="n">date_format</span><span class="err">'</span><span class="w">     </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">'</span><span class="n">d</span><span class="mf">.</span><span class="n">m</span><span class="mf">.</span><span class="n">Y</span><span class="err">'</span><span class="p">,</span><span class="w"></span>
<span class="p">),</span><span class="w"></span>
</code></pre>
</div>
<p>
 Parameter netid_attr represents (ldap) attribute name which has user's NetID stored in it,
parameter expirydate_attr represents (ldap) attribute name which has user's expiry date
(date must be formated as YYYYMMDDHHMMSSZ, e.g. 20111011235959Z) stored in it. Those two
attributes needs to be part of the attribute set, which is retrived from ldap during
authentication process.
Parameter warndaysbefore set as a number, which represents how many days before expiry
date the "about to expire" warning will show to the user.
Parameter date_format defines date representation format. PHP Date() syntax
is used. More info: http://php.net/manual/en/function.date.php
</p>
<p>
 P.S.
</p>
<p>
 Comments and bug reports please send to Alex Mihičinac
 <a href="mailto/alexm@arnes.si.html">
  alexm@arnes.si
 </a>
</p></body>
</html>
