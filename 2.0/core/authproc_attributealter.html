<!DOCTYPE html>
<html lang="en">
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Language" content="en">
  <meta name="google-site-verification" content="2S8M18BgYs8cLRL6ClTrfW_xGxfFtMZu2b2jhjrNlss">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>SimpleSAMLphp Documentation</title>

  <link rel="stylesheet" href="/res/css/style.css">
  <link rel="stylesheet" href="/res/css/layout.css">
</head>
<body>
<header>
 <div id="header">
  <div class="right">
   <form action="https://www.google.com/cse" method="get" style="margin-top: 2.5rem; margin-right: 2rem">
    <input name="cx" type="hidden" value="004202914224971217557:8ks4jjstupq"/>
    <input name="siteurl" type="hidden" value="www.google.com/cse/home?cx=004202914224971217557:8ks4jjstupq"/>
    <input name="adkw" type="hidden" value="AELymgVJ6Sk-kOvUjbxvgShTLwiFlma2evFuVCh0r8q23vn_4eVnkcdnPfbgMvYUTpJpVlb-KkGAKkbn0i-AlWHsVRR9O0J4CNb6cXFkEKRdjXxsC_NlVD4"/>
    <input name="q" placeholder="Search" type="search" value=""/>
   </form>
  </div>
  <div class="v-center logo-header">
   <div id="logo">
    <a href="https://simplesamlphp.org" style="color: #fff; text-decoration: none">
     <span class="simple">
      Simple
     </span>
     <span class="saml">
      SAML
     </span>
     <span class="simple">
      php
     </span>
    </a>
   </div>
  </div>
 </div>
 <!-- Grey header bar below -->
 <nav>
  <div id="headerbar" style="clear: both">
   <p id="breadcrumb">
    <a href="https://simplesamlphp.org">
     Home
    </a>
    Â» Documentation
   </p>
   <div class="mtoolbar">
    <div class="menuitem">
     <a href="/docs/2.0/index.html">
      2.0 (stable)
     </a>
    </div>
    <div class="menuitem">
     <a href="/docs/1.19/index.html">
      1.19
     </a>
    </div>
    <div class="menuitem">
     <a href="/docs/1.18/index.html">
      1.18
     </a>
    </div>
    <div class="menuitem">
     <a href="/docs/1.17/index.html">
      1.17
     </a>
    </div>
    <div class="menuitem">
     <a href="/docs/1.16/index.html">
      1.16
     </a>
    </div>
    <div class="menuitem first">
     <a href="/docs/devel/index.html">
      devel
     </a>
    </div>
    <div class="menuitem last">
     <a href="/docs/contributed_modules.html">
      Contributed modules
     </a>
    </div>
   </div>
   <br style="height: 0px; clear: both"/>
  </div>
  <!-- /#headerbar -->
 </nav>
 <div id="content">
 </div>
</header><main><h1 id="coreattributealter">
 <code>
  core:AttributeAlter
 </code>
</h1>
<p>
 This filter can be used to substitute and replace different parts of the attribute values based on regular expressions.
It can also be used to create new attributes based on existing values, or even to remove blacklisted values from
attributes.
</p>
<h2 id="parameters">
 Parameters
</h2>
<dl>
 <dt>
  <code>
   class
  </code>
 </dt>
 <dd>
  This is the name of the filter.
  It must be
  <code>
   'core:AttributeAlter'
  </code>
  .
 </dd>
 <dt>
  <code>
   subject
  </code>
 </dt>
 <dd>
  The attribute in which the search is performed.
  This parameter is REQUIRED and the filter will throw an exception if it is not set. The filter will
  stop quietly if the attribute specified here is empty or not found.
 </dd>
 <dt>
  <code>
   pattern
  </code>
 </dt>
 <dd>
  The pattern to look for inside the subject. Supports full Perl Compatible Regular Expressions (PCRE).
  This parameter is REQUIRED and the filter will throw an exception if it is not set.
 </dd>
 <dt>
  <code>
   replacement
  </code>
 </dt>
 <dd>
  The value used to replace the match. Back references are not supported.
  This parameter is REQUIRED, except when using the
  <code>
   %replace
  </code>
  or
  <code>
   %remove
  </code>
  options. If
  <code>
   %replace
  </code>
  is used and
  <code>
   replacement
  </code>
  is not set, then the match is used as a replacement.
 </dd>
 <dt>
  <code>
   target
  </code>
 </dt>
 <dd>
  The attribute where the replaced value will be placed.
  This parameter is OPTIONAL, and if not set,
  <code>
   subject
  </code>
  is used as
  <code>
   target
  </code>
  .
 </dd>
 <dt>
  <code>
   %replace
  </code>
 </dt>
 <dd>
  Indicates that the whole value of the attribute should be replaced if there is a match,
  instead of just the match. If there's no match, the value will not be changed. This parameter is OPTIONAL.
 </dd>
 <dt>
  <code>
   %remove
  </code>
 </dt>
 <dd>
  Indicates that the whole value of the attribute should be removed completely if there is a match.
  If no other values exist, the attribute will be removed completely.
  This parameter is OPTIONAL.
 </dd>
 <dt>
  <code>
   %merge
  </code>
 </dt>
 <dd>
  Indicates whether the altered values must be merged with the target attribute values. The default
  behaviour is to overwrite the target attribute completely.
  This parameter is OPTIONAL.
 </dd>
</dl>
<h2 id="examples">
 Examples
</h2>
<p>
 Change the domain on the
 <code>
  mail
 </code>
 attribute (when both the new and old domain are known):
</p>
<div class="codehilite">
 <pre><span></span><code>  10 =&gt; [
      'class' =&gt; 'core:AttributeAlter',
      'subject' =&gt; 'mail',
      'pattern' =&gt; '/olddomain.com/',
      'replacement' =&gt; 'newdomain.com',
  ],
</code></pre>
</div>
<p>
 Change the domain on the
 <code>
  mail
 </code>
 attribute (when new domain is known):
</p>
<div class="codehilite">
 <pre><span></span><code>  10 =&gt; [
      'class' =&gt; 'core:AttributeAlter',
      'subject' =&gt; 'mail',
      'pattern' =&gt; '/(?:[A-Za-z0-9-]+\.)+[A-Za-z]{2,6}$/',
      'replacement' =&gt; 'newdomain.com',
  ],
</code></pre>
</div>
<p>
 Set the eduPersonPrimaryAffiliation based on users' distinguishedName:
</p>
<div class="codehilite">
 <pre><span></span><code>  10 =&gt; [
      'class' =&gt; 'core:AttributeAlter',
      'subject' =&gt; 'dn',
      'pattern' =&gt; '/OU=Staff/',
      'replacement' =&gt; 'staff',
      'target' =&gt; 'eduPersonPrimaryAffiliation',
  ],
</code></pre>
</div>
<p>
 Normalize the eduPersonPrimaryAffiliation:
</p>
<div class="codehilite">
 <pre><span></span><code>  10 =&gt; [
      'class' =&gt; 'core:AttributeAlter',
      'subject' =&gt; 'eduPersonPrimaryAffiliation',
      'pattern' =&gt; '/Student in school/',
      'replacement' =&gt; 'student',
      '%replace',
  ],
</code></pre>
</div>
<p>
 Get the domain of the emailaddress and put it in a separate attribute:
</p>
<div class="codehilite">
 <pre><span></span><code>  10 =&gt; [
      'class' =&gt; 'core:AttributeAlter',
      'subject' =&gt; 'mail',
      'pattern' =&gt; '/(?:[A-Za-z0-9-]+\.)+[A-Za-z]{2,6}$/',
      'target' =&gt; 'domain',
      '%replace',
  ],
</code></pre>
</div>
<p>
 Defaulting an attribute to one value (add it with the default before altering)
unless another attribute meets a condition:
</p>
<div class="codehilite">
 <pre><span></span><code>  10 =&gt; [
      'class' =&gt; 'core:AttributeAdd',
      'myAttribute' =&gt; 'default-value'
  ],
  11 =&gt; [
      'class' =&gt; 'core:AttributeAlter',
      'subject' =&gt; 'entitlement',
      'pattern' =&gt; '/faculty/',
      'target' =&gt; 'myAttribute',
      '%replace',
  ],
</code></pre>
</div>
<p>
 Remove internal, private values from eduPersonEntitlement:
</p>
<div class="codehilite">
 <pre><span></span><code>  10 =&gt; [
      'class' =&gt; 'core:AttributeAlter',
      'subject' =&gt; 'eduPersonEntitlement',
      'pattern' =&gt; '/ldap-admin/',
      '%remove',
  ],
</code></pre>
</div>
<p>
 Set a value to be blank (which will be sent as an empty string):
</p>
<div class="codehilite">
 <pre><span></span><code>  10 =&gt; [
      'class' =&gt; 'core:AttributeAlter',
      'subject' =&gt; 'cn',
      'pattern' =&gt; '/No name/',
      'replacement' =&gt; '',
      '%replace',
  ],
</code></pre>
</div>
<p>
 Set a value to be NULL (which will be sent as a NULL value):
</p>
<div class="codehilite">
 <pre><span></span><code>  10 =&gt; [
      'class' =&gt; 'core:AttributeAlter',
      'subject' =&gt; 'telephone',
      'pattern' =&gt; '/NULL/',
      'replacement' =&gt; null,
      '%replace',
  ],
</code></pre>
</div></main></body>
</html>
