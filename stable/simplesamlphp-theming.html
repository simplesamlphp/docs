<!DOCTYPE html>
<html lang="en">
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Language" content="en">
  <meta name="google-site-verification" content="2S8M18BgYs8cLRL6ClTrfW_xGxfFtMZu2b2jhjrNlss">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>SimpleSAMLphp Documentation</title>

  <link rel="stylesheet" href="/res/css/style.css">
  <link rel="stylesheet" href="/res/css/layout.css">
</head>
<body>
<header>
 <div id="header">
  <div class="right">
   <form action="https://www.google.com/cse" method="get" style="margin-top: 2.5rem; margin-right: 2rem">
    <input name="cx" type="hidden" value="004202914224971217557:8ks4jjstupq"/>
    <input name="siteurl" type="hidden" value="www.google.com/cse/home?cx=004202914224971217557:8ks4jjstupq"/>
    <input name="adkw" type="hidden" value="AELymgVJ6Sk-kOvUjbxvgShTLwiFlma2evFuVCh0r8q23vn_4eVnkcdnPfbgMvYUTpJpVlb-KkGAKkbn0i-AlWHsVRR9O0J4CNb6cXFkEKRdjXxsC_NlVD4"/>
    <input name="q" placeholder="Search" type="search" value=""/>
   </form>
  </div>
  <div class="v-center logo-header">
   <div id="logo">
    <a href="https://simplesamlphp.org" style="color: #fff; text-decoration: none">
     <span class="simple">
      Simple
     </span>
     <span class="saml">
      SAML
     </span>
     <span class="simple">
      php
     </span>
    </a>
   </div>
  </div>
 </div>
 <!-- Grey header bar below -->
 <nav>
  <div id="headerbar" style="clear: both">
   <p id="breadcrumb">
    <a href="https://simplesamlphp.org">
     Home
    </a>
    » Documentation
   </p>
   <div class="mtoolbar">
    <div class="menuitem">
     <a href="/docs/2.0/index.html">
      2.0 (stable)
     </a>
    </div>
    <div class="menuitem">
     <a href="/docs/1.19/index.html">
      1.19
     </a>
    </div>
    <div class="menuitem first">
     <a href="/docs/devel/index.html">
      devel
     </a>
    </div>
    <div class="menuitem last">
     <a href="/docs/contributed_modules.html">
      Contributed modules
     </a>
    </div>
   </div>
   <br style="height: 0px; clear: both"/>
  </div>
  <!-- /#headerbar -->
 </nav>
 <div id="content">
 </div>
</header>
<main><h1 id="theming-the-user-interface-in-simplesamlphp">
 Theming the user interface in SimpleSAMLphp
</h1>
<div class="toc">
 <ul>
  <li>
   <a href="#theming-the-user-interface-in-simplesamlphp">
    Theming the user interface in SimpleSAMLphp
   </a>
   <ul>
    <li>
     <a href="#how-themes-work">
      How themes work
     </a>
     <ul>
      <li>
       <a href="#configuring-which-theme-to-use">
        Configuring which theme to use
       </a>
      </li>
      <li>
       <a href="#override-only-specific-templates">
        Override only specific templates
       </a>
      </li>
     </ul>
    </li>
    <li>
     <a href="#creating-your-first-theme">
      Creating your first theme
     </a>
    </li>
    <li>
     <a href="#adding-resource-files">
      Adding resource files
     </a>
    </li>
    <li>
     <a href="#a-custom-theme-controller">
      A custom theme controller
     </a>
    </li>
    <li>
     <a href="#migrating-to-twig-templates">
      Migrating to Twig templates
     </a>
    </li>
   </ul>
  </li>
 </ul>
</div>
<p>
 In SimpleSAMLphp every part that needs to interact with the user by using a web page, uses templates to present the HTML. SimpleSAMLphp comes with a default set of templates that presents an anonymous look.
</p>
<p>
 You may create your own theme, where you add one or more template files that will override the default ones. This document explains how to achieve that.
</p>
<h2 id="how-themes-work">
 How themes work
</h2>
<p>
 If you want to customize the UI, the right way to do that is to create a new
 <strong>
  theme
 </strong>
 . A theme is a set of templates that can be configured to override the default templates. Themes are a special type of SimpleSAMLphp module.
</p>
<h3 id="configuring-which-theme-to-use">
 Configuring which theme to use
</h3>
<p>
 In
 <code>
  config.php
 </code>
 there is a configuration option that controls theming. You need to set that option and also add the module that contains the theme to the list of enabled modules. Here is an example:
</p>
<div class="codehilite">
 <pre><span></span><code><span class="x">'module.enable' =&gt; [</span>
<span class="x">    ...</span>
<span class="x">    'mymodule' =&gt; true,</span>
<span class="x">],</span>

<span class="x">'theme.use' =&gt; 'mymodule:fancytheme',</span>
</code></pre>
</div>
<p>
 The
 <code>
  theme.use
 </code>
 parameter points to which theme that will be used. If some functionality in SimpleSAMLphp needs to present UI in example with the
 <code>
  logout.twig
 </code>
 template, it will first look for
 <code>
  logout.twig
 </code>
 in the
 <code>
  theme.use
 </code>
 theme, and if not found it will all fallback to look for the base templates.
</p>
<h3 id="override-only-specific-templates">
 Override only specific templates
</h3>
<p>
 The SimpleSAMLphp templates are derived from a base template and include other templates as building blocks. You only need to override the templates or building blocks needed for your change.
SimpleSAMLphp allows themes to override the included templates files only, if needed. That means you can create a new theme
 <code>
  fancytheme
 </code>
 that includes only a header and footer template. These templates may refer to your own CSS files, which means that a simple way of making a new look on SimpleSAMLphp is to create a new theme, and copy the existing header, but point to your own CSS instead of the default CSS. This means that for many theme requirements, you only need to specify a new header and footer template, and leave all other templates to SimpleSAMLphp's base versions.
</p>
<h2 id="creating-your-first-theme">
 Creating your first theme
</h2>
<p>
 The first thing you need to do is having a SimpleSAMLphp module to place your theme in. If you do not have a module already, create a new one:
</p>
<div class="codehilite">
 <pre><span></span><code><span class="nb">cd</span><span class="w"> </span>modules
mkdir<span class="w"> </span>mymodule
</code></pre>
</div>
<p>
 Then within this module, you can create a new theme named
 <code>
  fancytheme
 </code>
 .
</p>
<div class="codehilite">
 <pre><span></span><code><span class="nb">cd</span><span class="w"> </span>modules/mymodule
mkdir<span class="w"> </span>-p<span class="w"> </span>themes/fancytheme/default/
</code></pre>
</div>
<p>
 Now, in
 <code>
  config.php
 </code>
 , add the module to the list of enabled modules, and configure SimpleSAMLphp to actually use your new theme:
</p>
<div class="codehilite">
 <pre><span></span><code><span class="x">'module.enable' =&gt; [</span>
<span class="x">    ...</span>
<span class="x">    'mymodule' =&gt; true,</span>
<span class="x">],</span>
<span class="x">'theme.use' =&gt; 'mymodule:fancytheme',</span>
</code></pre>
</div>
<p>
 Next, we copy the header file from the base theme:
</p>
<div class="codehilite">
 <pre><span></span><code>cp<span class="w"> </span>templates/_header.twig<span class="w"> </span>modules/mymodule/themes/fancytheme/default/
</code></pre>
</div>
<p>
 In the
 <code>
  modules/mymodule/themes/fancytheme/default/_header.twig
 </code>
 file, type in something and go to the SimpleSAMLphp front page to see that your new theme is in use.
</p>
<h2 id="adding-resource-files">
 Adding resource files
</h2>
<p>
 You can put resource files within the
 <code>
  public/assets
 </code>
 folder of your module, to make your module completely independent with included css, icons etc.
</p>
<div class="codehilite">
 <pre><span></span><code>modules
└───mymodule
<span class="w">    </span>└───src
<span class="w">    </span>└───themes
<span class="w">    </span>└───public
<span class="w">        </span>└───assets
<span class="w">            </span>└───logo.svg
<span class="w">            </span>└───style.css
</code></pre>
</div>
<p>
 Reference these resources in your custom templates under
 <code>
  themes/fancytheme
 </code>
 by using a generator for the URL.
Example for a custom CSS stylesheet file:
</p>
<div class="codehilite">
 <pre><span></span><code><span class="cp">{%</span> <span class="k">block</span> <span class="nv">preload</span> <span class="cp">%}</span>
<span class="x">&lt;link rel="stylesheet" href="</span><span class="cp">{{</span> <span class="nv">asset</span><span class="o">(</span><span class="s1">'style.css'</span><span class="o">,</span> <span class="s1">'mymodule'</span><span class="o">)</span> <span class="cp">}}</span><span class="x">"&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</code></pre>
</div>
<h2 id="a-custom-theme-controller">
 A custom theme controller
</h2>
<p>
 If you have very specific requirements for your theme, you can define a custom theme controller
in
 <code>
  config.php
 </code>
 :
</p>
<div class="codehilite">
 <pre><span></span><code><span class="x">'theme.controller' =&gt; '\SimpleSAML\Module\mymodule\FancyThemeController',</span>
</code></pre>
</div>
<p>
 This requires you to implement
 <code>
  \SimpleSAML\XHTML\TemplateControllerInterface.php
 </code>
 in your module's
 <code>
  src
 </code>
 -directory.
The class can then modify the Twig Environment and the variables passed to the theme's templates. In short, this allows you to set additional global variables and to write your own Twig filters and functions.
</p>
<p>
 An example to put in
 <code>
  src/FancyThemeController.php
 </code>
 :
</p>
<div class="codehilite">
 <pre><span></span><code><span class="cp">&lt;?php</span>

<span class="k">namespace</span> <span class="nx">SimpleSAML\Module\mymodule</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Twig\Environment</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">SimpleSAML\XHTML\TemplateControllerInterface</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">FancyThemeController</span> <span class="k">implements</span> <span class="nx">TemplateControllerInterface</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * Modify the twig environment after its initialization (e.g. add filters or extensions).</span>
<span class="sd">     *</span>
<span class="sd">     * @param \Twig\Environment $twig The current twig environment.</span>
<span class="sd">     * @return void</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setUpTwig</span><span class="p">(</span><span class="nx">Environment</span> <span class="o">&amp;</span><span class="nv">$twig</span><span class="p">)</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * Add, delete or modify the data passed to the template.</span>
<span class="sd">     *</span>
<span class="sd">     * This method will be called right before displaying the template.</span>
<span class="sd">     *</span>
<span class="sd">     * @param array $data The current data used by the template.</span>
<span class="sd">     * @return void</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">display</span><span class="p">(</span><span class="k">array</span> <span class="o">&amp;</span><span class="nv">$data</span><span class="p">)</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="nv">$data</span><span class="p">[</span><span class="s1">'extra_info'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Extra information to use in your template'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>
<p>
 See the
 <a href="https://twig.symfony.com/doc/2.x/templates.html">
  Twig documentation
 </a>
 for more information on using variables and expressions in Twig templates, and the SimpleSAMLphp wiki for
 <a href="https://github.com/simplesamlphp/simplesamlphp/wiki/Twig-conventions">
  our conventions
 </a>
 .
</p>
<h2 id="migrating-to-twig-templates">
 Migrating to Twig templates
</h2>
<p>
 For existing themes that have been created before SimpleSAMLphp 2.0, you may need to upgrade them to the Twig
templating engine to be compatible with SimpleSAMLphp 2.0.
</p>
<p>
 Twig works by extending a base template, which can itself include other partial templates. Some of the content of the old
 <code>
  includes/header.php
 </code>
 template is now located in a separate
 <code>
  _header.twig
 </code>
 file. This can be customized by copying it from the base template:
</p>
<div class="codehilite">
 <pre><span></span><code>cp<span class="w"> </span>templates/_header.twig<span class="w"> </span>modules/mymodule/themes/fancytheme/default/
</code></pre>
</div>
<p>
 If you need to make more extensive customizations to the base template, you should copy it from the base theme:
</p>
<div class="codehilite">
 <pre><span></span><code>cp<span class="w"> </span>templates/base.twig<span class="w"> </span>modules/mymodule/themes/fancytheme/default/
</code></pre>
</div>
<p>
 Any references to
 <code>
  $this-&gt;data['baseurlpath']
 </code>
 in old-style templates can be replaced with
 <code>
  {{baseurlpath}}
 </code>
 in Twig templates. Likewise, references to
 <code>
  \SimpleSAML\Module::getModuleURL()
 </code>
 can be replaced with
 <code>
  {{baseurlpath}}module.php/mymodule/...
 </code>
 or the
 <code>
  asset()
 </code>
 function like shown above.
If you want to use the
 <code>
  asset()
 </code>
 function, you need to move the asserts from
 <code>
  public/
 </code>
 to
 <code>
  public/assets/
 </code>
 .
</p>
<p>
 Within templates each module is defined as a separate namespace matching the module name. This allows one template to reference templates from other modules using Twig's
 <code>
  @namespace_name/template_path
 </code>
 notation. For instance, a template in
 <code>
  mymodule
 </code>
 can include the widget template from the
 <code>
  yourmodule
 </code>
 module using the notation
 <code>
  @yourmodule/widget.twig
 </code>
 . A special namespace,
 <code>
  __parent__
 </code>
 , exists to allow theme developers to more easily extend a module's stock template.
</p>
<p>
 The wiki also includes some information on
 <a href="https://github.com/simplesamlphp/simplesamlphp/wiki/Migrating-translation-in-Twig">
  migrating translations
 </a>
 and
 <a href="https://github.com/simplesamlphp/simplesamlphp/wiki/Twig:-Migrating-templates">
  migrating templates
 </a>
 .
</p>
</main></body>
</html>
