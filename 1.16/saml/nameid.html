<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta http-equiv="Content-Language" content="en" />

	<!-- JQuery -->
	<!-- 
	<script type="text/javascript" src="/res/js/jquery.js"></script>
	<script type="text/javascript" src="/res/js/jquery-ui.js"></script>
	-->

	<style>
	  mark {
        background: orange;
        color: black;
      }
    </style>  

	
	<!-- Foodle: CSS -->	
	<link rel="stylesheet" media="screen" type="text/css" href="/res/js/uitheme/jquery-ui-themeroller.css" /> 
	<link rel="stylesheet" media="screen" type="text/css" href="/res/css/style.css" /> 
	<link rel="stylesheet" media="screen" type="text/css" href="/res/css/layout.css" /> 

	<title>SimpleSAMLphp Documentation</title> 
</head>





<body><!-- Red logo header --><header><div id="header"><div class="right">  <form style="margin-top: 2.5rem; margin-right: 2rem" method="get" action="https://www.google.com/cse">   <input type="hidden" name="cx" value="004202914224971217557:8ks4jjstupq" />    <input type="hidden" name="siteurl" value="www.google.com/cse/home?cx=004202914224971217557:8ks4jjstupq" />   <input type="hidden" name="adkw" value="AELymgVJ6Sk-kOvUjbxvgShTLwiFlma2evFuVCh0r8q23vn_4eVnkcdnPfbgMvYUTpJpVlb-KkGAKkbn0i-AlWHsVRR9O0J4CNb6cXFkEKRdjXxsC_NlVD4" />    <input type="search" name="q" placeholder="Search" value="" />  </form></div><div class="v-center logo-header">  <div id="logo">   <a href="https://simplesamlphp.github.io" style="color: #fff; text-decoration: none">     <span class="simple">Simple</span>      <span class="saml">SAML</span>      <span class="simple">php</span>    </a>  </div></div><!-- Grey header bar below --><div id="headerbar" style="clear: both"><p id="breadcrumb"><a href="https://simplesamlphp.github.io">Home</a> Â» Home</p><div id="langbar" style="clar: both"><div id="navigation">Documentation is available for the following versions: <a href="./../latest/index.html">latest</a> | <a href="./../1.19/index.html">1.19</a> | <a href="./../1.18/index.html">1.18</a> | <a href="./../1.17/index.html">1.17</a> | <a href="./../1.16/index.html">1.16</a> |  <a href="./../contributed_modules.html"> Contributed modules</a></div></div></div><!-- /#headerbar --><div id="content"></header><h1>
 NameID generation filters
</h1>
<p>
 This document describes the NameID generation filters in the saml module.
</p>
<h2>
 Common options
</h2>
<p>
 <code>
  NameQualifier
 </code>
 :   The NameQualifier attribute for the generated NameID.
    This can be a string that is used as the value directly.
    It can also be
 <code>
  true
 </code>
 , in which case we use the IdP entity ID as the NameQualifier.
    If it is
 <code>
  false
 </code>
 , no NameQualifier will be included.
</p>
<p>
 :   The default is
 <code>
  false
 </code>
 , which means that we will not include a NameQualifier by default.
</p>
<p>
 <code>
  SPNameQualifier
 </code>
 :   The SPNameQualifier attribute for the generated NameID.
    This can be a string that is used as the value directly.
    It can also be
 <code>
  true
 </code>
 , in which case we use the SP entity ID as the SPNameQualifier.
    If it is
 <code>
  false
 </code>
 , no SPNameQualifier will be included.
</p>
<p>
 :   The default is
 <code>
  true
 </code>
 , which means that we will use the SP entity ID.
</p>
<h2>
 <code>
  saml:AttributeNameID
 </code>
</h2>
<p>
 Uses the value of an attribute to generate a NameID.
</p>
<h3>
 Options
</h3>
<p>
 <code>
  attribute
 </code>
 :   The name of the attribute we should use as the unique user ID.
</p>
<p>
 <code>
  Format
 </code>
 :   The
 <code>
  Format
 </code>
 attribute of the generated NameID.
</p>
<h2>
 <code>
  saml:PersistentNameID
 </code>
</h2>
<p>
 Generates a persistent NameID with the format
 <code>
  urn:oasis:names:tc:SAML:2.0:nameid-format:persistent
 </code>
 .
The filter will take the user ID from the attribute described in the
 <code>
  attribute
 </code>
 option, and hash it with the
 <code>
  secretsalt
 </code>
 from
 <code>
  config.php
 </code>
 , and the SP and IdP entity ID.
The resulting hash is sent as the persistent NameID.
</p>
<h3>
 Options
</h3>
<p>
 <code>
  attribute
 </code>
 :   The name of the attribute we should use as the unique user ID.
</p>
<h2>
 <code>
  saml:TransientNameID
 </code>
</h2>
<p>
 Generates a transient NameID with the format
 <code>
  urn:oasis:names:tc:SAML:2.0:nameid-format:transient
 </code>
 .
</p>
<p>
 No extra options are available for this filter.
</p>
<h2>
 <code>
  saml:SQLPersistentNameID
 </code>
</h2>
<p>
 Generates and stores persistent NameIDs in a SQL database.
</p>
<p>
 This filter generates and stores a persistent NameID in a SQL database.
To use this filter, either specify the
 <code>
  store
 </code>
 option and a database,
or configure SimpleSAMLphp to use a SQL datastore.
See the
 <code>
  store.type
 </code>
 configuration option in
 <code>
  config.php
 </code>
 .
</p>
<h3>
 Options
</h3>
<p>
 <code>
  attribute
 </code>
 :   The name of the attribute we should use as the unique user ID.
</p>
<p>
 <code>
  allowUnspecified
 </code>
 :   Whether a persistent NameID should be created if the SP does not specify any NameID format in the request.
    The default is
 <code>
  false
 </code>
 .
</p>
<p>
 <code>
  allowDifferent
 </code>
 :   Whether a persistent NameID should be created if there are only other NameID formats specified in the request or the SP's metadata.
    The default is
 <code>
  false
 </code>
 .
</p>
<p>
 <code>
  alwaysCreate
 </code>
 :   Whether to ignore an explicit
 <code>
  AllowCreate="false"
 </code>
 in the authentication request's NameIDPolicy.
    The default is
 <code>
  false
 </code>
 , which will only create new NameIDs when the SP specifies
 <code>
  AllowCreate="true"
 </code>
 in the authentication request.
</p>
<p>
 <code>
  store
 </code>
 :   An array of database options passed to
 <code>
  \SimpleSAML\Database
 </code>
 , keys prefixed with
 <code>
  database.
 </code>
 .
    The default is
 <code>
  []
 </code>
 , which uses the global SQL datastore.
</p>
<p>
 Setting both
 <code>
  allowUnspecified
 </code>
 and
 <code>
  alwaysCreate
 </code>
 to
 <code>
  true
 </code>
 causes
 <code>
  saml:SQLPersistentNameID
 </code>
 to behave like
 <code>
  saml:PersistentNameID
 </code>
 (and other NameID generation filters), at the expense of creating unnecessary entries in the SQL datastore.
</p>
<h2>
 <code>
  saml:PersistentNameID2TargetedID
 </code>
</h2>
<p>
 Stores a persistent NameID in the
 <code>
  eduPersonTargetedID
 </code>
 -attribute.
</p>
<p>
 This filter is not actually a NameID generation filter.
Instead, it takes a persistent NameID and adds it as an attribute in the assertion.
This can be used to set the
 <code>
  eduPersonTargetedID
 </code>
 -attribute to the same value as the persistent NameID.
</p>
<h3>
 Options
</h3>
<p>
 <code>
  attribute
 </code>
 :   The name of the attribute we should store the result in.
    The default is
 <code>
  eduPersonTargetedID
 </code>
 .
</p>
<p>
 <code>
  nameId
 </code>
 :   Whether the generated attribute should be an saml:NameID element.
    The default is
 <code>
  true
 </code>
 .
</p>
<h2>
 Example
</h2>
<p>
 This example makes three NameIDs available:
</p>
<pre><code>  'authproc' =&gt; [
      1 =&gt; [
          'class' =&gt; 'saml:TransientNameID',
      ],
      2 =&gt; [
          'class' =&gt; 'saml:PersistentNameID',
          'attribute' =&gt; 'eduPersonPrincipalName',
      ],
      3 =&gt; [
          'class' =&gt; 'saml:AttributeNameID',
          'attribute' =&gt; 'mail',
          'Format' =&gt; 'urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress',
      ],
  ],
</code></pre>
<p>
 Storing persistent NameIDs in a SQL database:
</p>
<pre><code>  'authproc' =&gt; [
      1 =&gt; [
          'class' =&gt; 'saml:TransientNameID',
      ],
      2 =&gt; [
          'class' =&gt; 'saml:SQLPersistentNameID',
          'attribute' =&gt; 'eduPersonPrincipalName',
      ],
  ],
</code></pre>
<p>
 Generating Persistent NameID and eduPersonTargetedID.
</p>
<pre><code>  'authproc' =&gt; [
      // Generate the persistent NameID.
      2 =&gt; [
          'class' =&gt; 'saml:PersistentNameID',
          'attribute' =&gt; 'eduPersonPrincipalName',
      ],
      // Add the persistent to the eduPersonTargetedID attribute
      60 =&gt; [
          'class' =&gt; 'saml:PersistentNameID2TargetedID',
          'attribute' =&gt; 'eduPersonTargetedID', // The default
          'nameId' =&gt; true, // The default
      ],
      // Use OID attribute names.
      90 =&gt; [
          'class' =&gt; 'core:AttributeMap',
          'name2oid',
      ],
  ],
  // The URN attribute NameFormat for OID attributes.
  'attributes.NameFormat' =&gt; 'urn:oasis:names:tc:SAML:2.0:attrname-format:uri',
  'attributeencodings' =&gt; [
      'urn:oid:1.3.6.1.4.1.5923.1.1.1.10' =&gt; 'raw', /* eduPersonTargetedID with oid NameFormat is a raw XML value */
  ],
</code></pre></div>    <!-- /#content -->

<div id="footer">
    <a href="https://www.uninett.no/"><img id="ulogo" alt="notes" src="/res/uninettlogo.png" /SS></a>
</div><!-- /#footer -->

</body>
</html>
